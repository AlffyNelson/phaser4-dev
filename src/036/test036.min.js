!function(){"use strict";function t(t){if("complete"===document.readyState||"interactive"===document.readyState)return void t();const e=()=>{document.removeEventListener("deviceready",e,!0),document.removeEventListener("DOMContentLoaded",e,!0),window.removeEventListener("load",e,!0),t()};document.body?window.hasOwnProperty("cordova")?document.addEventListener("deviceready",e,!0):(document.addEventListener("DOMContentLoaded",e,!0),window.addEventListener("load",e,!0)):window.setTimeout(e,20)}const e=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function i(t){let e="";for(let i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+=`if(test == ${i}.0){}`);return e}class r{constructor(t=1,e=0,i=0,r=0,s=0,a=1,n=0,h=0,o=0,l=0,d=1,c=0,u=0,m=0,x=0,g=1){this.set(t,e,i,r,s,a,n,h,o,l,d,c,u,m,x,g)}set(t=1,e=0,i=0,r=0,s=0,a=1,n=0,h=0,o=0,l=0,d=1,c=0,u=0,m=0,x=0,g=1){return this.m00=t,this.m01=e,this.m02=i,this.m03=r,this.m10=s,this.m11=a,this.m12=n,this.m13=h,this.m20=o,this.m21=l,this.m22=d,this.m23=c,this.m30=u,this.m31=m,this.m32=x,this.m33=g,this}zero(){return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}identity(){return this.set()}getArray(){return[this.m00,this.m01,this.m02,this.m03,this.m10,this.m11,this.m12,this.m13,this.m20,this.m21,this.m22,this.m23,this.m30,this.m31,this.m32,this.m33]}fromArray(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}[Symbol.iterator](){return this.getArray()[Symbol.iterator]()}}const s={fragmentShader:"\nprecision highp float;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nuniform sampler2D uTexture[%count%];\n\nvoid main (void)\n{\n    vec4 color;\n\n    %forloop%\n\n    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);\n}",vertexShader:"\nprecision highp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute float aTextureId;\nattribute vec4 aTintColor;\n\nuniform mat4 uProjectionMatrix;\nuniform mat4 uCameraMatrix;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nvoid main (void)\n{\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vTintColor = aTintColor;\n\n    gl_Position = uProjectionMatrix * uCameraMatrix * vec4(aVertexPosition, 0.0, 1.0);\n}"};class a{constructor(t,e={}){this.renderer=t,this.gl=t.gl;const{batchSize:i=2e3,dataSize:r=4,indexSize:a=4,vertexElementSize:n=6,quadIndexSize:h=6,fragmentShader:o=s.fragmentShader,vertexShader:l=s.vertexShader}=e;this.batchSize=i,this.dataSize=r,this.indexSize=a,this.vertexElementSize=n,this.vertexByteSize=n*r,this.quadByteSize=4*this.vertexByteSize,this.quadElementSize=4*n,this.quadIndexSize=h,this.bufferByteSize=i*this.quadByteSize,this.createBuffers(),this.createShaders(o,l)}createBuffers(){let t=[];for(let e=0;e<this.batchSize*this.indexSize;e+=this.indexSize)t.push(e+0,e+1,e+2,e+2,e+3,e+0);this.data=new ArrayBuffer(this.bufferByteSize),this.index=new Uint16Array(t),this.vertexViewF32=new Float32Array(this.data),this.vertexViewU32=new Uint32Array(this.data);const e=this.gl;this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.data,e.DYNAMIC_DRAW),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.index,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),t=[]}createShaders(t,e){const i=this.gl,r=this.renderer.maxTextures;let s="";for(let t=0;t<r;t++)t>0&&(s+="\n    else "),t<r-1&&(s+=`if (vTextureId < ${t}.5)`),s+="\n    {",s+=`\n        color = texture2D(uTexture[${t}], vTextureCoord);`,s+="\n    }";t=(t=t.replace(/%count%/gi,`${r}`)).replace(/%forloop%/gi,s);const a=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(a,t),i.compileShader(a);const n=i.createShader(i.VERTEX_SHADER);i.shaderSource(n,e),i.compileShader(n);const h=i.createProgram();i.attachShader(h,n),i.attachShader(h,a),i.linkProgram(h),i.useProgram(h),this.program=h;const o=i.getAttribLocation(h,"aVertexPosition"),l=i.getAttribLocation(h,"aTextureCoord"),d=i.getAttribLocation(h,"aTextureId"),c=i.getAttribLocation(h,"aTintColor"),u=i.getUniformLocation(h,"uProjectionMatrix"),m=i.getUniformLocation(h,"uCameraMatrix"),x=i.getUniformLocation(h,"uTexture");i.enableVertexAttribArray(o),i.enableVertexAttribArray(l),i.enableVertexAttribArray(d),i.enableVertexAttribArray(c),this.attribs={position:o,textureCoord:l,textureIndex:d,color:c},this.uniforms={projectionMatrix:u,cameraMatrix:m,textureLocation:x}}packColor(t,e){return((255&(255*e|0))<<24|t)>>>0}bind(){const t=this.gl,e=this.renderer,i=this.vertexByteSize,r=this.uniforms,s=this.attribs;t.useProgram(this.program),t.uniformMatrix4fv(r.projectionMatrix,!1,e.projectionMatrix),t.uniformMatrix4fv(r.cameraMatrix,!1,e.cameraMatrix),t.uniform1iv(r.textureLocation,e.textureIndex),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(s.position,2,t.FLOAT,!1,i,0),t.vertexAttribPointer(s.textureCoord,2,t.FLOAT,!1,i,8),t.vertexAttribPointer(s.textureIndex,1,t.FLOAT,!1,i,16),t.vertexAttribPointer(s.color,4,t.UNSIGNED_BYTE,!0,i,20),this.count=0}batchSprite(t){this.count===this.batchSize&&this.flush();let e=this.count*this.quadElementSize;const i=this.vertexViewF32,r=this.vertexViewU32,s=t.frame,a=s.texture.glIndex,n=t.vertices,h=n[0],o=n[1],l=n[2],d=n[3];i[e++]=h.x,i[e++]=h.y,i[e++]=s.u0,i[e++]=s.v0,i[e++]=a,r[e++]=this.packColor(h.color,h.alpha),i[e++]=l.x,i[e++]=l.y,i[e++]=s.u0,i[e++]=s.v1,i[e++]=a,r[e++]=this.packColor(l.color,l.alpha),i[e++]=d.x,i[e++]=d.y,i[e++]=s.u1,i[e++]=s.v1,i[e++]=a,r[e++]=this.packColor(d.color,d.alpha),i[e++]=o.x,i[e++]=o.y,i[e++]=s.u1,i[e++]=s.v0,i[e++]=a,r[e++]=this.packColor(o.color,o.alpha),this.count++}flush(){const t=this.count;if(0===t)return;const e=this.gl,i=t*this.quadByteSize;if(i===this.bufferByteSize)e.bufferData(e.ARRAY_BUFFER,this.data,e.DYNAMIC_DRAW);else{let t=this.vertexViewF32.subarray(0,i);e.bufferSubData(e.ARRAY_BUFFER,0,t)}e.drawElements(e.TRIANGLES,t*this.quadIndexSize,e.UNSIGNED_SHORT,0),this.count=0}}class n{constructor(t,e){this.contextOptions={alpha:!1,antialias:!0,premultipliedAlpha:!1,stencil:!0,preserveDrawingBuffer:!1},this.clearColor=[0,0,0,1],this.resolution={x:0,y:0},this.maxTextures=0,this.clearBeforeRender=!0,this.resolution.x=t,this.resolution.y=e,this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e,this.gl=this.canvas.getContext("webgl",this.contextOptions),this.getMaxTextures(),this.shader=new a(this),this.activeTextures=Array(this.maxTextures),this.projectionMatrix=function(t,e,i,s,a,n){const h=1/(t-e),o=1/(i-s),l=1/(a-n);return new r(-2*h,0,0,0,0,-2*o,0,0,0,0,2*l,0,(t+e)*h,(s+i)*o,(n+a)*l,1)}(0,t,e,0,-1e3,1e3),this.cameraMatrix=new r,this.startActiveTexture=0}setBackgroundColor(t){const e=this.clearColor;let i=t>>16&255,r=t>>8&255,s=255&t,a=t>16777215?t>>>24:255;return e[0]=i/255,e[1]=r/255,e[2]=s/255,e[3]=a/255,this}getMaxTextures(){const t=this.gl;let r=function(t,r){const s=r.createShader(r.FRAGMENT_SHADER);for(;;){const a=e.replace(/%forloop%/gi,i(t));if(r.shaderSource(s,a),r.compileShader(s),r.getShaderParameter(s,r.COMPILE_STATUS))break;t=t/2|0}return t}(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),t);for(let e=0;e<r;e++){let i=t.createTexture();t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,255,255]))}this.maxTextures=r,this.textureIndex=Array.from(Array(r).keys())}isSizePowerOfTwo(t,e){return t>0&&0==(t&t-1)&&e>0&&0==(e&e-1)}createGLTexture(t){const e=this.gl,i=e.createTexture();e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,i),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_LINEAR);const r=this.isSizePowerOfTwo(t.width,t.height),s=r?e.REPEAT:e.CLAMP_TO_EDGE;return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,s),r&&e.generateMipmap(e.TEXTURE_2D),i}render(t){this.startActiveTexture++;let e=this.startActiveTexture,i=0;const r=this.shader,s=this.maxTextures,a=this.activeTextures,n=this.gl,h=this.clearColor;n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE),n.enable(n.BLEND),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA),n.viewport(0,0,this.resolution.x,this.resolution.y),n.bindFramebuffer(n.FRAMEBUFFER,null),this.clearBeforeRender&&(n.clearColor(h[0],h[1],h[2],h[3]),n.clear(n.COLOR_BUFFER_BIT)),r.bind();for(let h=0;h<t.length;h++){let o=t[h];if(o.updateTransform(),o.visible&&o.renderable&&o.texture){let t=o.texture;t.glIndexCounter<e&&(t.glIndexCounter=e,i<s&&(a[i]=t,t.glIndex=i,n.activeTexture(n.TEXTURE0+i),n.bindTexture(n.TEXTURE_2D,t.glTexture),i++)),r.batchSprite(o)}}r.flush()}}class h{constructor(t,e,i,r,s){this.hasLoaded=!1,this.type=t,this.key=e,this.url=i,this.loadHandler=r,this.config=s}}class o{constructor(t){this.baseURL="",this.path="",this.crossOrigin=void 0,this.maxParallelDownloads=32,this.isLoading=!1,this.game=t,this.reset()}reset(){this.isLoading=!1,this.queue=[],this.inflight=new Map}start(t){this.isLoading||(this.queue.length>0?(this.isLoading=!0,this.onComplete=t,this.nextFile()):t())}nextFile(){if(this.queue.length){let t=this.queue.shift();this.inflight.set(t.url,t),t.loadHandler(t)}else 0===this.inflight.size&&this.stop()}stop(){this.isLoading=!1,this.onComplete()}fileComplete(t){this.inflight.delete(t.url),this.nextFile()}fileError(t){this.inflight.delete(t.url),this.nextFile()}totalFilesToLoad(){return this.queue.length+this.inflight.size}image(t,e){let i=new h("image",t,this.getURL(t,e,".png"),t=>this.imageTagLoader(t));return this.queue.push(i),this}spritesheet(t,e,i){let r=new h("spritesheet",t,this.getURL(t,e,".png"),t=>this.imageTagLoader(t));return r.config=i,this.queue.push(r),this}imageTagLoader(t){t.data=new Image,this.crossOrigin&&(t.data.crossOrigin=this.crossOrigin),t.data.onload=()=>{t.data.onload=null,t.data.onerror=null,t.hasLoaded=!0,"image"===t.type?this.game.textures.addImage(t.key,t.data):"spritesheet"===t.type&&this.game.textures.addSpriteSheet(t.key,t.data,t.config),this.fileComplete(t)},t.data.onerror=()=>{t.data.onload=null,t.data.onerror=null,t.hasLoaded=!0,this.fileError(t)},t.data.src=t.url,t.data.complete&&t.data.width&&t.data.height&&(t.data.onload=null,t.data.onerror=null,t.hasLoaded=!0,"image"===t.type?this.game.textures.addImage(t.key,t.data):"spritesheet"===t.type&&this.game.textures.addSpriteSheet(t.key,t.data,t.config),this.fileComplete(t))}getURL(t,e,i){return e||(e=t+i),this.baseURL+this.path+e}setBaseURL(t){return""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.baseURL=t,this}setPath(t){return""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.path=t,this}setCORS(t){return this.crossOrigin=t,this}}class l{constructor(t){this.scene=t,this.game=t.game,this.list=[]}add(t){const e=this.list;return-1===e.indexOf(t)&&e.push(t),this}remove(t){const e=this.list,i=e.indexOf(t);return-1!==i&&e.splice(i,1),this}}class d{constructor(t,e,i,r,s,a){this.texture=t,this.key=e,this.x=i,this.y=r,this.width=s,this.height=a,this.updateUVs()}updateUVs(){const{x:t,y:e,width:i,height:r}=this,s=this.texture.width,a=this.texture.height;this.u0=t/s,this.v0=e/a,this.u1=(t+i)/s,this.v1=(e+r)/a}}class c{constructor(t=0,e=0,i=16777215,r=1){this.x=t,this.y=e,this.color=i,this.alpha=r}}class u{constructor(t=0,e=0){this.set(t,e)}set(t=0,e=0){return this.x=t,this.y=e,this}zero(){return this.set()}getArray(){return[this.x,this.y]}fromArray(t){return this.set(t[0],t[1])}[Symbol.iterator](){return this.getArray()[Symbol.iterator]()}}class m extends class extends class{constructor(){this.visible=!0,this.renderable=!0,this._position=new u,this._scale=new u(1,1),this._skew=new u,this._origin=new u(.5,.5),this._rotation=0,this.localTransform={a:1,b:0,c:0,d:1,tx:0,ty:0},this.worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0}}updateTransform(t){const e=this.localTransform,i=this.worldTransform;if(e.tx=this.x,e.ty=this.y,!t&&!this.parent)return i.a=e.a,i.b=e.b,i.c=e.c,i.d=e.d,i.tx=e.tx,void(i.ty=e.ty);t||(t=this.parent);const r=t.worldTransform;let{a:s,b:a,c:n,d:h,tx:o,ty:l}=e;i.a=s*r.a+a*r.c,i.b=s*r.b+a*r.d,i.c=n*r.a+h*r.c,i.d=n*r.b+h*r.d,i.tx=o*r.a+l*r.c+r.tx,i.ty=o*r.b+l*r.d+r.ty}setSize(t,e){return this.width=t,this.height=e,this}setPosition(t,e){return this._position.set(t,e),this}setScale(t,e=t){return this._scale.set(t,e),this.updateCache()}setSkew(t,e){return this._skew.set(t,e),this.updateCache()}setOrigin(t,e=t){return this._origin.set(t,e),this}setRotation(t){return this._rotation=t,this.updateCache()}updateCache(){const t=this.localTransform,{_rotation:e,_skew:i,_scale:r}=this;return t.a=Math.cos(e+i.y)*r.x,t.b=Math.sin(e+i.y)*r.x,t.c=-Math.sin(e-i.x)*r.y,t.d=Math.cos(e-i.x)*r.y,this}set x(t){this._position.x=t}get x(){return this._position.x}set y(t){this._position.y=t}get y(){return this._position.y}set rotation(t){this._rotation=t,this.updateCache()}get rotation(){return this._rotation}set scaleX(t){this._scale.x=t,this.updateCache()}get scaleX(){return this._scale.x}set scaleY(t){this._scale.y=t,this.updateCache()}get scaleY(){return this._scale.y}set skewX(t){this._skew.x=t,this.updateCache()}get skewX(){return this._skew.x}set skewY(t){this._skew.y=t,this.updateCache()}get skewY(){return this._skew.y}}{constructor(){super(),this.children=[]}addChild(t){return this.addChildAt(t,this.children.length)}addChildAt(t,e){return e>=0&&e<=this.children.length&&(t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t)),t}swapChildren(t,e){if(t!==e)return;let i=this.getChildIndex(t),r=this.getChildIndex(e);if(i<0||r<0)throw new Error("swap: Both children must belong to the same parent");this.children[i]=e,this.children[r]=t}getChildIndex(t){const e=this.children.indexOf(t);if(-1===e)throw new Error("Supplied DisplayObject not child of the caller");return e}setChildIndex(t,e){const i=this.children;if(e<0||e>=i.length)throw new Error("Index "+e+" out of bounds");const r=this.getChildIndex(t);i.splice(r,1),i.splice(e,0,t)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error("Index "+t+" out of bounds");return this.children[t]}removeChild(t){const e=this.children.indexOf(t);if(-1!==e)return this.removeChildAt(e)}removeChildAt(t){const e=this.getChildAt(t);return e&&(e.parent=void 0,this.children.splice(t,1)),e}removeChildren(t=0,e){const i=this.children;void 0===e&&(e=i.length);const r=e-t;if(r>0&&r<=e){const e=i.splice(t,r);return e.forEach(t=>{t.parent=void 0}),e}if(0===r&&0===i.length)return[];throw new Error("Range Error. Values out of bounds")}updateTransform(t){if(!this.visible)return;super.updateTransform(t);const e=this.children;for(let t=0;t<e.length;t++)e[t].updateTransform()}}{constructor(t,e,i,r,s){super(),this.texture=null,this.frame=null,this.vertices=[new c,new c,new c,new c],this._alpha=1,this._tint=16777215,this.scene=t,this.setTexture(r,s),this.setPosition(e,i)}setTexture(t,e){return this.texture=t instanceof class{constructor(t,e){this.glIndex=0,this.glIndexCounter=-1,this.key=t,this.image=e,this.frames=new Map,this.width=this.image.width,this.height=this.image.height,this.add("__BASE",0,0,this.width,this.height)}add(t,e,i,r,s){if(this.frames.has(t))return null;let a=new d(this,t,e,i,r,s);return this.frames.set(t,a),this.firstFrame&&"__BASE"!==this.firstFrame.key||(this.firstFrame=a),a}get(t){if(!t)return this.firstFrame;let e=this.frames.get(t);return e||(console.warn("Texture.frame missing: "+t),e=this.firstFrame),e}}?t:this.scene.textures.get(t),this.setFrame(e)}setFrame(t){const e=this.texture.get(t);return this.frame=e,this.setSize(e.width,e.height)}setAlpha(t=1,e=t,i=t,r=t){const s=this.vertices;return s[0].alpha=t,s[1].alpha=e,s[2].alpha=i,s[3].alpha=r,this}setTint(t=16777215,e=t,i=t,r=t){const s=this.vertices;return s[0].color=t,s[1].color=e,s[2].color=i,s[3].color=r,this}update(){}updateTransform(){super.updateTransform();const t=this.width,e=this.height,i=-this._origin.x*t,r=i+t,s=-this._origin.y*e,a=s+e,{a:n,b:h,c:o,d:l,tx:d,ty:c}=this.worldTransform,u=i*n,m=i*h,x=s*o,g=s*l,f=r*n,p=r*h,T=a*o,E=a*l,v=this.vertices;v[0].x=u+x+d,v[0].y=m+g+c,v[1].x=f+x+d,v[1].y=p+g+c,v[2].x=u+T+d,v[2].y=m+E+c,v[3].x=f+T+d,v[3].y=p+E+c}get alpha(){return this._alpha}set alpha(t){this._alpha=t,this.setAlpha(t)}get tint(){return this._tint}set tint(t){this._tint=t,this.setTint(t)}}class x{constructor(t){this.scene=t,this.displayList=t.children}sprite(t,e,i,r){let s=new m(this.scene,t,e,i,r);return this.displayList.add(s),s}}class g{constructor(t){this.game=t,this.load=t.loader,this.textures=t.textures,this.children=new l(this),this.add=new x(this)}init(){}preload(){}create(){}update(t){}}class f{constructor(t,e){this.glIndex=0,this.glIndexCounter=-1,this.key=t,this.image=e,this.frames=new Map,this.width=this.image.width,this.height=this.image.height,this.add("__BASE",0,0,this.width,this.height)}add(t,e,i,r,s){if(this.frames.has(t))return null;let a=new d(this,t,e,i,r,s);return this.frames.set(t,a),this.firstFrame&&"__BASE"!==this.firstFrame.key||(this.firstFrame=a),a}get(t){if(!t)return this.firstFrame;let e=this.frames.get(t);return e||(console.warn("Texture.frame missing: "+t),e=this.firstFrame),e}}class p{constructor(t){this.game=t,this.textures=new Map}get(t){return this.textures.has(t)?this.textures.get(t):this.textures.get("__MISSING")}addImage(t,e){let i=null;return this.textures.has(t)||(i=new f(t,e),i.glTexture=this.game.renderer.createGLTexture(i.image),this.textures.set(t,i)),i}addSpriteSheet(t,e,i){let r=null;return this.textures.has(t)||(r=new f(t,e),r.glTexture=this.game.renderer.createGLTexture(r.image),function(t,e,i,r,s,a){let{frameWidth:n=null,frameHeight:h=null,startFrame:o=0,endFrame:l=-1,margin:d=0,spacing:c=0}=a;if(h||(h=n),null===n)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");let u=Math.floor((r-d+c)/(n+c))*Math.floor((s-d+c)/(h+c));0===u&&console.warn("SpriteSheet frame dimensions will result in zero frames."),(o>u||o<-u)&&(o=0),o<0&&(o=u+o),-1!==l&&(u=o+(l+1));let m=d,x=d,g=0,f=0;for(let a=0;a<u;a++){g=0,f=0;let o=m+n,l=x+h;o>r&&(g=o-r),l>s&&(f=l-s),t.add(a,e+m,i+x,n-g,h-f),m+=n+c,m+n>r&&(m=d,x+=h+c)}}(r,0,0,r.width,r.height,i),this.textures.set(t,r)),r}}class T{constructor(e){this.VERSION="4.0.0-beta1",this.isPaused=!1,this.isBooted=!1;const{width:i=800,height:r=600,backgroundColor:s=0,parent:a=document.body,scene:n=new g(this)}=e;this.scene=n,t(()=>this.boot(i,r,s,a))}boot(t,e,i,r){this.isBooted=!0,this.textures=new p(this),this.loader=new o(this);const s=new n(t,e);s.setBackgroundColor(i),function(t,e){let i;if(e)"string"==typeof e?i=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(i=e);else if(t.parentElement)return t;i||(i=document.body),i.appendChild(t)}(s.canvas,r),this.renderer=s,this.banner(this.VERSION);const a=this.scene;a instanceof g?this.scene=this.createSceneFromInstance(a):"object"==typeof a?this.scene=this.createSceneFromObject(a):"function"==typeof a&&(this.scene=this.createSceneFromFunction(a)),this.scene.init(),this.scene.preload(),this.loader.totalFilesToLoad()>0?this.loader.start(()=>this.start()):this.start()}createSceneFromInstance(t){return t.game=this,t.load=this.loader,t}createSceneFromObject(t){let e=new g(this);return["init","preload","create","update","render"].forEach(i=>{t.hasOwnProperty(i)&&(e[i]=t[i])}),e}createSceneFromFunction(t){var e=new t(this);return e instanceof g?this.createSceneFromInstance(e):e}start(){this.scene.create(),requestAnimationFrame(t=>this.step(t))}banner(t){let e="";const i=[e];let r;["#e000e0","#8000e0","#2000e0","#0000c0","#000080"].forEach(t=>{e=e.concat("%c "),i.push("background: "+t),r=t}),i[i.length-1]="color: #ffffff; background: "+r,i.push("background: rgba(0,0,0,0)"),e=e.concat("Phaser Nano v"+t),e=e.concat(" %c https://phaser4.io"),i[0]=e,console.log.apply(console,i)}step(t){this.isPaused?requestAnimationFrame(t=>this.step(t)):(this.scene.update(t),this.renderer.render(this.scene.children.list),requestAnimationFrame(t=>this.step(t)))}}class E extends g{constructor(t){super(t)}preload(){this.load.image("logo","../assets/512x512.png"),this.load.image("box","../assets/box-item-boxed.png"),this.load.image("brain","../assets/brain.png")}create(){document.getElementById("toggle").addEventListener("click",()=>{this.game.isPaused=!this.game.isPaused}),this.sprite1=this.add.sprite(400,300,"logo");const t=this.add.sprite(0,0,"box"),e=this.add.sprite(-256,-256,"box"),i=this.add.sprite(256,256,"box");this.sprite1.addChild(t),this.sprite1.addChild(e),this.sprite1.addChild(i)}update(t){this.sprite1.rotation+=.01}}new T({width:800,height:600,backgroundColor:102,parent:"gameParent",scene:E})}();
