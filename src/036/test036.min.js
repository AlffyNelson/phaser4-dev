!function(){"use strict";function t(t){if("complete"===document.readyState||"interactive"===document.readyState)return void t();const e=()=>{document.removeEventListener("deviceready",e,!0),document.removeEventListener("DOMContentLoaded",e,!0),window.removeEventListener("load",e,!0),t()};document.body?window.hasOwnProperty("cordova")?document.addEventListener("deviceready",e,!0):(document.addEventListener("DOMContentLoaded",e,!0),window.addEventListener("load",e,!0)):window.setTimeout(e,20)}const e=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function i(t){let e="";for(let i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+=`if(test == ${i}.0){}`);return e}const s={fragmentShader:"\nprecision highp float;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nuniform sampler2D uTexture[%count%];\n\nvoid main (void)\n{\n    vec4 color;\n\n    %forloop%\n\n    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);\n}",vertexShader:"\nprecision highp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute float aTextureId;\nattribute vec4 aTintColor;\n\nuniform mat4 uProjectionMatrix;\nuniform mat4 uCameraMatrix;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nvoid main (void)\n{\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vTintColor = aTintColor;\n\n    gl_Position = uProjectionMatrix * uCameraMatrix * vec4(aVertexPosition, 0.0, 1.0);\n}"};class r{constructor(t,e={}){this.renderer=t,this.gl=t.gl;const{batchSize:i=2e3,dataSize:r=4,indexSize:h=4,vertexElementSize:n=6,quadIndexSize:a=6,fragmentShader:o=s.fragmentShader,vertexShader:d=s.vertexShader}=e;this.batchSize=i,this.dataSize=r,this.indexSize=h,this.vertexElementSize=n,this.vertexByteSize=n*r,this.quadByteSize=4*this.vertexByteSize,this.quadElementSize=4*n,this.quadIndexSize=a,this.bufferByteSize=i*this.quadByteSize,this.createBuffers(),this.createShaders(o,d)}createBuffers(){let t=[];for(let e=0;e<this.batchSize*this.indexSize;e+=this.indexSize)t.push(e+0,e+1,e+2,e+2,e+3,e+0);this.data=new ArrayBuffer(this.bufferByteSize),this.index=new Uint16Array(t),this.vertexViewF32=new Float32Array(this.data),this.vertexViewU32=new Uint32Array(this.data);const e=this.gl;this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.data,e.DYNAMIC_DRAW),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.index,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),t=[]}createShaders(t,e){const i=this.gl,s=this.renderer.maxTextures;let r="";for(let t=0;t<s;t++)t>0&&(r+="\n    else "),t<s-1&&(r+=`if (vTextureId < ${t}.5)`),r+="\n    {",r+=`\n        color = texture2D(uTexture[${t}], vTextureCoord);`,r+="\n    }";t=(t=t.replace(/%count%/gi,`${s}`)).replace(/%forloop%/gi,r);const h=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(h,t),i.compileShader(h);const n=i.createShader(i.VERTEX_SHADER);i.shaderSource(n,e),i.compileShader(n);const a=i.createProgram();i.attachShader(a,n),i.attachShader(a,h),i.linkProgram(a),i.useProgram(a),this.program=a;const o=i.getAttribLocation(a,"aVertexPosition"),d=i.getAttribLocation(a,"aTextureCoord"),l=i.getAttribLocation(a,"aTextureId"),c=i.getAttribLocation(a,"aTintColor"),u=i.getUniformLocation(a,"uProjectionMatrix"),m=i.getUniformLocation(a,"uCameraMatrix"),x=i.getUniformLocation(a,"uTexture");i.enableVertexAttribArray(o),i.enableVertexAttribArray(d),i.enableVertexAttribArray(l),i.enableVertexAttribArray(c),this.attribs={position:o,textureCoord:d,textureIndex:l,color:c},this.uniforms={projectionMatrix:u,cameraMatrix:m,textureLocation:x}}packColor(t,e){return((255&(255*e|0))<<24|t)>>>0}bind(){const t=this.gl,e=this.renderer,i=this.vertexByteSize,s=this.uniforms,r=this.attribs;t.useProgram(this.program),t.uniformMatrix4fv(s.projectionMatrix,!1,e.projectionMatrix),t.uniformMatrix4fv(s.cameraMatrix,!1,e.camera.matrix),t.uniform1iv(s.textureLocation,e.textureIndex),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(r.position,2,t.FLOAT,!1,i,0),t.vertexAttribPointer(r.textureCoord,2,t.FLOAT,!1,i,8),t.vertexAttribPointer(r.textureIndex,1,t.FLOAT,!1,i,16),t.vertexAttribPointer(r.color,4,t.UNSIGNED_BYTE,!0,i,20),this.count=0}batchSprite(t){this.count===this.batchSize&&this.flush();let e=this.count*this.quadElementSize;const i=this.vertexViewF32,s=this.vertexViewU32,r=t.frame,h=r.texture.glIndex,n=t.updateVertices(),a=n[0],o=n[1],d=n[2],l=n[3];i[e++]=a.x,i[e++]=a.y,i[e++]=r.u0,i[e++]=r.v0,i[e++]=h,s[e++]=this.packColor(a.color,a.alpha),i[e++]=d.x,i[e++]=d.y,i[e++]=r.u0,i[e++]=r.v1,i[e++]=h,s[e++]=this.packColor(d.color,d.alpha),i[e++]=l.x,i[e++]=l.y,i[e++]=r.u1,i[e++]=r.v1,i[e++]=h,s[e++]=this.packColor(l.color,l.alpha),i[e++]=o.x,i[e++]=o.y,i[e++]=r.u1,i[e++]=r.v0,i[e++]=h,s[e++]=this.packColor(o.color,o.alpha),this.count++}flush(){const t=this.count;if(0===t)return;const e=this.gl,i=t*this.quadByteSize;if(i===this.bufferByteSize)e.bufferData(e.ARRAY_BUFFER,this.data,e.DYNAMIC_DRAW);else{let t=this.vertexViewF32.subarray(0,i);e.bufferSubData(e.ARRAY_BUFFER,0,t)}e.drawElements(e.TRIANGLES,t*this.quadIndexSize,e.UNSIGNED_SHORT,0),this.count=0}}class h{constructor(t=1,e=0,i=0,s=0,r=0,h=1,n=0,a=0,o=0,d=0,l=1,c=0,u=0,m=0,x=0,g=1){this.set(t,e,i,s,r,h,n,a,o,d,l,c,u,m,x,g)}set(t=1,e=0,i=0,s=0,r=0,h=1,n=0,a=0,o=0,d=0,l=1,c=0,u=0,m=0,x=0,g=1){return this.m00=t,this.m01=e,this.m02=i,this.m03=s,this.m10=r,this.m11=h,this.m12=n,this.m13=a,this.m20=o,this.m21=d,this.m22=l,this.m23=c,this.m30=u,this.m31=m,this.m32=x,this.m33=g,this}zero(){return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}identity(){return this.set()}getArray(){return[this.m00,this.m01,this.m02,this.m03,this.m10,this.m11,this.m12,this.m13,this.m20,this.m21,this.m22,this.m23,this.m30,this.m31,this.m32,this.m33]}fromArray(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}[Symbol.iterator](){return this.getArray()[Symbol.iterator]()}}function n(t,e,i,s){return t.m00*=e,t.m01*=e,t.m02*=e,t.m03*=e,t.m10*=i,t.m11*=i,t.m12*=i,t.m13*=i,t.m20*=s,t.m21*=s,t.m22*=s,t.m23*=s,t}function a(t,e=0,i=0,s=0){const{m00:r,m01:h,m02:n,m03:a,m10:o,m11:d,m12:l,m13:c,m20:u,m21:m,m22:x,m23:g,m30:f,m31:p,m32:T,m33:w}=t;return t.m30=r*e+o*i+u*s+f,t.m31=h*e+d*i+m*s+p,t.m32=n*e+l*i+x*s+T,t.m33=a*e+c*i+g*s+w,t}class o{constructor(t,e,i){e||(e=t.width),i||(i=t.height),this.renderer=t,this.matrix=new h,this.width=e,this.height=i}set x(t){this._x=t,a(this.matrix,t,this._y)}get x(){return this._x}set y(t){this._y=t,a(this.matrix,this._x,t)}get y(){return this._y}set rotation(t){this._rotation=t,function(t,e){const i=Math.sin(e),s=Math.cos(e),{m00:r,m01:h,m02:n,m03:a,m10:o,m11:d,m12:l,m13:c}=t;t.m00=r*s+o*i,t.m01=h*s+d*i,t.m02=n*s+l*i,t.m03=a*s+c*i,t.m10=o*s-r*i,t.m11=d*s-h*i,t.m12=l*s-n*i,t.m13=c*s-a*i}(this.matrix,t)}get rotation(){return this._rotation}set scaleX(t){this._scaleX=t,n(this.matrix,t,this._scaleY,1)}get scaleX(){return this._scaleX}set scaleY(t){this._scaleY=t,n(this.matrix,this._scaleX,t,1)}get scaleY(){return this._scaleY}}class d{constructor(t,e,i=1){this.contextOptions={alpha:!1,antialias:!1,premultipliedAlpha:!1,stencil:!1,preserveDrawingBuffer:!1},this.clearColor=[0,0,0,1],this.maxTextures=0,this.clearBeforeRender=!0,this.autoResize=!0,this.contextLost=!1,this.width=t,this.height=e,this.resolution=i;const s=document.createElement("canvas");s.addEventListener("webglcontextlost",t=>this.onContextLost(t),!1),s.addEventListener("webglcontextrestored",()=>this.onContextRestored(),!1),this.canvas=s,this.initContext(),this.shader=new r(this),this.camera=new o(this)}initContext(){const t=this.canvas.getContext("webgl",this.contextOptions);this.gl=t,this.getMaxTextures(),t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),this.shader&&(this.shader.gl=t),this.resize(this.width,this.height,this.resolution)}resize(t,e,i=1){this.width=t*i,this.height=e*i,this.resolution=i;const s=this.canvas;s.width=this.width,s.height=this.height,this.autoResize&&(s.style.width=this.width/i+"px",s.style.height=this.height/i+"px"),this.gl.viewport(0,0,this.width,this.height),this.projectionMatrix=this.ortho(t,e,-1e3,1e3)}ortho(t,e,i,s){return new Float32Array([1/-t*-2,0,0,0,0,1/e*-2,0,0,0,0,1/(i-s)*2,0,-1,1,0,1])}onContextLost(t){t.preventDefault(),this.contextLost=!0}onContextRestored(){this.contextLost=!1,this.initContext()}setBackgroundColor(t){const e=this.clearColor,i=t>>16&255,s=t>>8&255,r=255&t,h=t>16777215?t>>>24:255;return e[0]=i/255,e[1]=s/255,e[2]=r/255,e[3]=h/255,this}getMaxTextures(){const t=this.gl;let s=function(t,s){const r=s.createShader(s.FRAGMENT_SHADER);for(;;){const h=e.replace(/%forloop%/gi,i(t));if(s.shaderSource(r,h),s.compileShader(r),s.getShaderParameter(r,s.COMPILE_STATUS))break;t=t/2|0}return t}(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),t);for(let e=0;e<s;e++){let i=t.createTexture();t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,255,255]))}this.maxTextures=s,this.textureIndex=Array.from(Array(s).keys()),this.activeTextures=Array(s),this.currentActiveTexture=0,this.startActiveTexture=0}isSizePowerOfTwo(t,e){return t>0&&0==(t&t-1)&&e>0&&0==(e&e-1)}createGLTexture(t){const e=this.gl,i=e.createTexture();e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,i),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);const s=this.isSizePowerOfTwo(t.width,t.height),r=s?e.REPEAT:e.CLAMP_TO_EDGE;return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,r),s&&e.generateMipmap(e.TEXTURE_2D),i}render(t){if(this.contextLost)return;this.currentActiveTexture=0,this.startActiveTexture++;const e=this.shader,i=this.gl,s=this.clearColor;i.bindFramebuffer(i.FRAMEBUFFER,null),i.enable(i.BLEND),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.viewport(0,0,this.width,this.height),this.clearBeforeRender&&(i.clearColor(s[0],s[1],s[2],s[3]),i.clear(i.COLOR_BUFFER_BIT)),e.bind(),this.renderChildren(t),e.flush()}renderChildren(t){const e=this.gl,i=this.shader,s=this.maxTextures,r=this.activeTextures,h=this.startActiveTexture;let n=this.currentActiveTexture;const a=t.children;for(let t=0;t<a.length;t++){let o=a[t];if(o.willRender()){if(o.texture){let t=o.texture;t.glIndexCounter<h&&(t.glIndexCounter=h,n<s&&(r[n]=t,t.glIndex=n,e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,t.glTexture),n++,this.currentActiveTexture=n)),i.batchSprite(o)}o.size&&this.renderChildren(o)}}}}class l{constructor(t,e,i,s,r){this.hasLoaded=!1,this.type=t,this.key=e,this.url=i,this.loadHandler=s,this.config=r}}class c{constructor(t){this.baseURL="",this.path="",this.crossOrigin=void 0,this.maxParallelDownloads=32,this.isLoading=!1,this.game=t,this.reset()}reset(){this.isLoading=!1,this.queue=[],this.inflight=new Map}start(t){this.isLoading||(this.queue.length>0?(this.isLoading=!0,this.onComplete=t,this.nextFile()):t())}nextFile(){if(this.queue.length){let t=this.queue.shift();this.inflight.set(t.url,t),t.loadHandler(t)}else 0===this.inflight.size&&this.stop()}stop(){this.isLoading=!1,this.onComplete()}fileComplete(t){this.inflight.delete(t.url),this.nextFile()}fileError(t){this.inflight.delete(t.url),this.nextFile()}totalFilesToLoad(){return this.queue.length+this.inflight.size}image(t,e){let i=new l("image",t,this.getURL(t,e,".png"),t=>this.imageTagLoader(t));return this.queue.push(i),this}spritesheet(t,e,i){let s=new l("spritesheet",t,this.getURL(t,e,".png"),t=>this.imageTagLoader(t));return s.config=i,this.queue.push(s),this}imageTagLoader(t){t.data=new Image,this.crossOrigin&&(t.data.crossOrigin=this.crossOrigin),t.data.onload=()=>{t.data.onload=null,t.data.onerror=null,t.hasLoaded=!0,"image"===t.type?this.game.textures.addImage(t.key,t.data):"spritesheet"===t.type&&this.game.textures.addSpriteSheet(t.key,t.data,t.config),this.fileComplete(t)},t.data.onerror=()=>{t.data.onload=null,t.data.onerror=null,t.hasLoaded=!0,this.fileError(t)},t.data.src=t.url,t.data.complete&&t.data.width&&t.data.height&&(t.data.onload=null,t.data.onerror=null,t.hasLoaded=!0,"image"===t.type?this.game.textures.addImage(t.key,t.data):"spritesheet"===t.type&&this.game.textures.addSpriteSheet(t.key,t.data,t.config),this.fileComplete(t))}getURL(t,e,i){return e||(e=t+i),this.baseURL+this.path+e}setBaseURL(t){return""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.baseURL=t,this}setPath(t){return""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.path=t,this}setCORS(t){return this.crossOrigin=t,this}}class u{constructor(t=0,e=0){this.set(t,e)}set(t=0,e=0){return this.x=t,this.y=e,this}zero(){return this.set()}getArray(){return[this.x,this.y]}fromArray(t){return this.set(t[0],t[1])}[Symbol.iterator](){return this.getArray()[Symbol.iterator]()}}class m extends class{constructor(){this.texture=null,this.frame=null,this.visible=!0,this.renderable=!0,this._position=new u,this._scale=new u(1,1),this._skew=new u,this._origin=new u(.5,.5),this._rotation=0,this._alpha=1,this.localTransform={a:1,b:0,c:0,d:1,tx:0,ty:0},this.worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0}}updateTransform(){const t=this.parent,e=this.localTransform,i=this.worldTransform;if(e.tx=this.x,e.ty=this.y,!t)return i.a=e.a,i.b=e.b,i.c=e.c,i.d=e.d,i.tx=e.tx,void(i.ty=e.ty);const s=t.worldTransform;let{a:r,b:h,c:n,d:a,tx:o,ty:d}=e;return i.a=r*s.a+h*s.c,i.b=r*s.b+h*s.d,i.c=n*s.a+a*s.c,i.d=n*s.b+a*s.d,i.tx=o*s.a+d*s.c+s.tx,i.ty=o*s.b+d*s.d+s.ty,this}willRender(){return this.visible&&this.renderable&&this._alpha>0}setAlpha(t=1){return this._alpha=t,this}setSize(t,e){return this.width=t,this.height=e,this}setPosition(t,e){return this._position.set(t,e),this.updateTransform()}setScale(t,e=t){return this._scale.set(t,e),this.updateCache()}setSkew(t,e){return this._skew.set(t,e),this.updateCache()}setOrigin(t,e=t){return this._origin.set(t,e),this}setRotation(t){return this._rotation=t,this.updateCache()}updateCache(){const t=this.localTransform,{_rotation:e,_skew:i,_scale:s}=this;return t.a=Math.cos(e+i.y)*s.x,t.b=Math.sin(e+i.y)*s.x,t.c=-Math.sin(e-i.x)*s.y,t.d=Math.cos(e-i.x)*s.y,this.updateTransform()}set x(t){this._position.x=t,this.updateTransform()}get x(){return this._position.x}set y(t){this._position.y=t,this.updateTransform()}get y(){return this._position.y}set rotation(t){this._rotation=t,this.updateCache()}get rotation(){return this._rotation}set scaleX(t){this._scale.x=t,this.updateCache()}get scaleX(){return this._scale.x}set scaleY(t){this._scale.y=t,this.updateCache()}get scaleY(){return this._scale.y}set skewX(t){this._skew.x=t,this.updateCache()}get skewX(){return this._skew.x}set skewY(t){this._skew.y=t,this.updateCache()}get skewY(){return this._skew.y}get alpha(){return this._alpha}set alpha(t){this._alpha=t}}{constructor(){super(),this.children=[]}addChild(...t){return t.forEach(t=>{this.addChildAt(t,this.children.length)}),this}addChildAt(t,e){return e>=0&&e<=this.children.length&&(t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t)),t}swapChildren(t,e){if(t!==e)return;let i=this.getChildIndex(t),s=this.getChildIndex(e);if(i<0||s<0)throw new Error("swap: Both children must belong to the same parent");this.children[i]=e,this.children[s]=t}getChildIndex(t){const e=this.children.indexOf(t);if(-1===e)throw new Error("Supplied DisplayObject not child of the caller");return e}setChildIndex(t,e){const i=this.children;if(e<0||e>=i.length)throw new Error("Index "+e+" out of bounds");const s=this.getChildIndex(t);i.splice(s,1),i.splice(e,0,t)}getChildAt(t){if(t<0||t>=this.size)throw new Error("Index "+t+" out of bounds");return this.children[t]}removeChild(t){const e=this.children.indexOf(t);if(-1!==e)return this.removeChildAt(e)}removeChildAt(t){const e=this.getChildAt(t);return e&&(e.parent=void 0,this.children.splice(t,1)),e}removeChildren(t=0,e){const i=this.children;void 0===e&&(e=i.length);const s=e-t;if(s>0&&s<=e){const e=i.splice(t,s);return e.forEach(t=>{t.parent=void 0}),e}if(0===s&&0===i.length)return[];throw new Error("Range Error. Values out of bounds")}update(){const t=this.children;for(let e=0;e<t.length;e++)t[e].update()}updateTransform(){super.updateTransform();const t=this.children;for(let e=0;e<t.length;e++)t[e].updateTransform();return this}get size(){return this.children.length}}class x{constructor(t){this.game=t,this.load=t.loader,this.textures=t.textures,this.world=new m}init(){}preload(){}create(){}update(t){}}class g{constructor(t,e,i,s,r,h){this.texture=t,this.key=e,this.x=i,this.y=s,this.width=r,this.height=h,this.updateUVs()}updateUVs(){const{x:t,y:e,width:i,height:s}=this,r=this.texture.width,h=this.texture.height;this.u0=t/r,this.v0=e/h,this.u1=(t+i)/r,this.v1=(e+s)/h}}class f{constructor(t,e){this.glIndex=0,this.glIndexCounter=-1,this.key=t,this.image=e,this.frames=new Map,this.width=this.image.width,this.height=this.image.height,this.add("__BASE",0,0,this.width,this.height)}add(t,e,i,s,r){if(this.frames.has(t))return null;let h=new g(this,t,e,i,s,r);return this.frames.set(t,h),this.firstFrame&&"__BASE"!==this.firstFrame.key||(this.firstFrame=h),h}get(t){if(!t)return this.firstFrame;let e=this.frames.get(t);return e||(console.warn("Texture.frame missing: "+t),e=this.firstFrame),e}}class p{constructor(t){this.game=t,this.textures=new Map}get(t){return this.textures.has(t)?this.textures.get(t):this.textures.get("__MISSING")}addImage(t,e){let i=null;return this.textures.has(t)||(i=new f(t,e),i.glTexture=this.game.renderer.createGLTexture(i.image),this.textures.set(t,i)),i}addSpriteSheet(t,e,i){let s=null;return this.textures.has(t)||(s=new f(t,e),s.glTexture=this.game.renderer.createGLTexture(s.image),function(t,e,i,s,r,h){let{frameWidth:n=null,frameHeight:a=null,startFrame:o=0,endFrame:d=-1,margin:l=0,spacing:c=0}=h;if(a||(a=n),null===n)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");let u=Math.floor((s-l+c)/(n+c))*Math.floor((r-l+c)/(a+c));0===u&&console.warn("SpriteSheet frame dimensions will result in zero frames."),(o>u||o<-u)&&(o=0),o<0&&(o=u+o),-1!==d&&(u=o+(d+1));let m=l,x=l,g=0,f=0;for(let h=0;h<u;h++){g=0,f=0;let o=m+n,d=x+a;o>s&&(g=o-s),d>r&&(f=d-r),t.add(h,e+m,i+x,n-g,a-f),m+=n+c,m+n>s&&(m=l,x+=a+c)}}(s,0,0,s.width,s.height,i),this.textures.set(t,s)),s}}class T{constructor(e){this.VERSION="4.0.0-beta1",this.isPaused=!1,this.isBooted=!1;const{width:i=800,height:s=600,backgroundColor:r=0,parent:h=document.body,scene:n=new x(this)}=e;this.scene=n,t(()=>this.boot(i,s,r,h))}boot(t,e,i,s){this.isBooted=!0,this.textures=new p(this),this.loader=new c(this);const r=new d(t,e);r.setBackgroundColor(i),function(t,e){let i;if(e)"string"==typeof e?i=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(i=e);else if(t.parentElement)return t;i||(i=document.body),i.appendChild(t)}(r.canvas,s),this.renderer=r,this.banner(this.VERSION);const h=this.scene;h instanceof x?this.scene=this.createSceneFromInstance(h):"object"==typeof h?this.scene=this.createSceneFromObject(h):"function"==typeof h&&(this.scene=this.createSceneFromFunction(h)),this.scene.init(),this.scene.preload(),this.loader.totalFilesToLoad()>0?this.loader.start(()=>this.start()):this.start()}createSceneFromInstance(t){return t.game=this,t.load=this.loader,t}createSceneFromObject(t){let e=new x(this);return["init","preload","create","update","render"].forEach(i=>{t.hasOwnProperty(i)&&(e[i]=t[i])}),e}createSceneFromFunction(t){var e=new t(this);return e instanceof x?this.createSceneFromInstance(e):e}start(){this.scene.create(),requestAnimationFrame(t=>this.step(t))}banner(t){console.log("%cPhaser Nano v"+t+"%c https://phaser4.io","padding: 2px 20px; color: #fff; background: linear-gradient(to right, #00bcc3, #3e0081 10%, #3e0081 90%, #3e0081 10%, #00bcc3)","")}step(t){this.isPaused?requestAnimationFrame(t=>this.step(t)):(this.scene.world.update(),this.scene.update(t),this.renderer.render(this.scene.world),requestAnimationFrame(t=>this.step(t)))}}class w{constructor(t=0,e=0,i=16777215,s=1){this.x=t,this.y=e,this.color=i,this.alpha=s}}class E extends m{constructor(t,e,i,s,r){super(),this.vertices=[new w,new w,new w,new w],this._tint=16777215,this.scene=t,this.setTexture(s,r),this.setPosition(e,i)}setTexture(t,e){return this.texture=t instanceof class{constructor(t,e){this.glIndex=0,this.glIndexCounter=-1,this.key=t,this.image=e,this.frames=new Map,this.width=this.image.width,this.height=this.image.height,this.add("__BASE",0,0,this.width,this.height)}add(t,e,i,s,r){if(this.frames.has(t))return null;let h=new g(this,t,e,i,s,r);return this.frames.set(t,h),this.firstFrame&&"__BASE"!==this.firstFrame.key||(this.firstFrame=h),h}get(t){if(!t)return this.firstFrame;let e=this.frames.get(t);return e||(console.warn("Texture.frame missing: "+t),e=this.firstFrame),e}}?t:this.scene.textures.get(t),this.setFrame(e)}setFrame(t){const e=this.texture.get(t);return this.frame=e,this.setSize(e.width,e.height)}setAlpha(t=1,e=t,i=t,s=t){const r=this.vertices;return r[0].alpha=t,r[1].alpha=e,r[2].alpha=i,r[3].alpha=s,this}setTint(t=16777215,e=t,i=t,s=t){const r=this.vertices;return r[0].color=t,r[1].color=e,r[2].color=i,r[3].color=s,this}updateVertices(){const t=this.width,e=this.height,i=-this._origin.x*t,s=i+t,r=-this._origin.y*e,h=r+e,{a:n,b:a,c:o,d:d,tx:l,ty:c}=this.worldTransform,u=i*n,m=i*a,x=r*o,g=r*d,f=s*n,p=s*a,T=h*o,w=h*d,E=this.vertices;return E[0].x=u+x+l,E[0].y=m+g+c,E[1].x=f+x+l,E[1].y=p+g+c,E[2].x=u+T+l,E[2].y=m+w+c,E[3].x=f+T+l,E[3].y=p+w+c,E}set alpha(t){this._alpha=t,this.setAlpha(t)}get tint(){return this._tint}set tint(t){this._tint=t,this.setTint(t)}}class v extends E{constructor(t,e,i,s,r,h=0,n=512){super(t,e,i,s,r),this.direction=0,this.speed=2,this.direction=h,0===h?(this.startX=e,this.startY=i,this.endX=e+n,this.endY=i+n):1===h?(this.startX=e-n,this.startY=i,this.endX=e,this.endY=i+n):2===h?(this.startX=e-n,this.startY=i-n,this.endX=e,this.endY=i):3===h&&(this.startX=e,this.startY=i-n,this.endX=e+n,this.endY=i)}update(){switch(this.direction){case 0:this.x+=this.speed,this.x>=this.endX&&(this.x=this.endX,this.direction=1);break;case 1:this.y+=this.speed,this.y>=this.endY&&(this.y=this.endY,this.direction=2);break;case 2:this.x-=this.speed,this.x<=this.startX&&(this.x=this.startX,this.direction=3);break;case 3:this.y-=this.speed,this.y<=this.startY&&(this.y=this.startY,this.direction=0)}}}class y extends x{constructor(t){super(t)}preload(){this.load.image("512","../assets/checker.png"),this.load.image("128","../assets/lance-overdose-loader-eye.png"),this.load.image("logo","../assets/logo.png"),this.load.image("brain","../assets/brain.png")}create(){this.container=new E(this,400,300,"512");const t=new v(this,-256,-256,"brain",null,0),e=new v(this,256,-256,"brain",null,1),i=new v(this,256,256,"brain",null,2),s=new v(this,-256,256,"brain",null,3),r=new E(this,0,0,"logo").setScale(.7),h=new E(this,0,0,"logo").setScale(.8),n=new E(this,0,0,"logo").setScale(.9),a=new E(this,0,0,"logo").setScale(1);this.container.addChild(t,e,i,s,r,h,n,a),this.world.addChild(this.container)}update(){this.container.rotation+=.005,this.container.getChildAt(4).rotation+=.037,this.container.getChildAt(5).rotation+=.038,this.container.getChildAt(6).rotation+=.039,this.container.getChildAt(7).rotation+=.04}}!function(){let t=new T({width:800,height:600,backgroundColor:102,parent:"gameParent",scene:y});document.getElementById("toggle").addEventListener("click",()=>{t.isPaused=!t.isPaused})}()}();
