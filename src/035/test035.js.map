{"version":3,"file":"test035.js","sources":["part09.ts","test035.ts"],"sourcesContent":["export default function ()\r\n{\r\n    //  Encapsulate a quad, so we can have multple quads (still using modelTransform approach)\r\n\r\n    const fs = `\r\n    precision mediump float;\r\n\r\n    varying vec4 vColor;\r\n    \r\n    void main (void)\r\n    {\r\n        gl_FragColor = vec4(vColor.r, vColor.g, vColor.b, vColor.a);\r\n    }\r\n    `;\r\n    \r\n    const vs = `\r\n    attribute vec4 aColor;\r\n    attribute vec2 aVertexPosition;\r\n\r\n    uniform mat4 uProjectionMatrix;\r\n    uniform mat4 uModelTransform;\r\n\r\n    varying vec4 vColor;\r\n    \r\n    void main (void)\r\n    {\r\n        vColor = aColor;\r\n    \r\n        gl_Position = uProjectionMatrix * uModelTransform * vec4(aVertexPosition, 0.0, 1.0);\r\n    }\r\n    `;\r\n\r\n    const canvas = document.getElementById('game') as HTMLCanvasElement;\r\n\r\n    canvas.width = 800;\r\n    canvas.height = 600;\r\n\r\n    const gl: WebGLRenderingContext = canvas.getContext('webgl');\r\n    \r\n    //  Create the shaders\r\n    \r\n    const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\r\n    \r\n    gl.shaderSource(fragmentShader, fs);\r\n    gl.compileShader(fragmentShader);\r\n    \r\n    const vertexShader = gl.createShader(gl.VERTEX_SHADER);\r\n    \r\n    gl.shaderSource(vertexShader, vs);\r\n    gl.compileShader(vertexShader);\r\n    \r\n    const program = gl.createProgram();\r\n    \r\n    gl.attachShader(program, vertexShader);\r\n    gl.attachShader(program, fragmentShader);\r\n    gl.linkProgram(program);\r\n    \r\n    gl.useProgram(program);\r\n    \r\n    const vertexPositionAttrib = gl.getAttribLocation(program, 'aVertexPosition');\r\n    const vertexColorAttrib = gl.getAttribLocation(program, 'aColor');\r\n    const uModelTransform = gl.getUniformLocation(program, 'uModelTransform');\r\n    const uProjectionMatrix = gl.getUniformLocation(program, 'uProjectionMatrix');\r\n\r\n    gl.enableVertexAttribArray(vertexPositionAttrib);\r\n    gl.enableVertexAttribArray(vertexColorAttrib);\r\n    \r\n    const vertices = [];\r\n    const indices = [];\r\n\r\n    let totalQuads = 0;\r\n\r\n    const resolution = { x: 800, y: 600 };\r\n\r\n    //  Creates a 1 unit quad\r\n    function addQuad (r: number = 1, g: number = 1, b: number = 1, a: number = 1)\r\n    {\r\n        //  A 1 unit quad\r\n        let x1 = 0;\r\n        let y1 = 0;\r\n        let x2 = 1;\r\n        let y2 = 1;\r\n\r\n        //  top-left\r\n        vertices.push(x1, y1, r, g, b, a);\r\n\r\n        //  bottom-left\r\n        vertices.push(x1, y2, r, g, b, a);\r\n\r\n        //  bottom-right\r\n        vertices.push(x2, y2, r, g, b, a);\r\n\r\n        //  top-right\r\n        vertices.push(x2, y1, r, g, b, a);\r\n\r\n        const offset = totalQuads * 4;\r\n\r\n        indices.push(\r\n            offset, offset + 1, offset + 2,\r\n            offset, offset + 2, offset + 3\r\n        );\r\n\r\n        totalQuads++;\r\n    }\r\n\r\n    class Quad\r\n    {\r\n        x: number;\r\n        y: number;\r\n        width: number;\r\n        height: number;\r\n        rotation: number;\r\n        scaleX: number;\r\n        scaleY: number;\r\n        modelTransform: Float32Array;\r\n        r: number;\r\n\r\n        constructor (x: number, y: number, width: number, height: number, r: number = 0, g: number = 1, b: number = 0, a: number = 1)\r\n        {\r\n            this.x = x;\r\n            this.y = y;\r\n            this.width = width;\r\n            this.height = height;\r\n            this.rotation = 0;\r\n            this.scaleX = 1;\r\n            this.scaleY = 1;\r\n            this.modelTransform = new Float32Array([ 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1 ]);\r\n\r\n            this.r = 0.01;\r\n\r\n            addQuad(r, g, b, a);\r\n        }\r\n\r\n        update ()\r\n        {\r\n            this.rotation += this.r;\r\n\r\n            Identity(this.modelTransform);\r\n\r\n            //  Values are in screen space because we started with an ortho matrix\r\n            Translate(this.modelTransform, this.x, this.y, 0);\r\n   \r\n            RotateZ(this.modelTransform, this.rotation);\r\n    \r\n            //  Set origin to the center of the quad\r\n            Translate(this.modelTransform, this.width / -2, this.height / -2, 0);\r\n    \r\n            //  Because it's a 1x1 unit quad, scale it to 256 x 256\r\n            Scale(this.modelTransform, this.width * this.scaleX, this.height * this.scaleY, 0);\r\n        }\r\n    }\r\n\r\n    const quads: Quad[] = [];\r\n\r\n    quads.push(new Quad(400, 300, 128, 128));\r\n    quads.push(new Quad(400, 400, 64, 64, 1, 0, 0));\r\n    quads.push(new Quad(200, 400, 64, 64, 0, 0, 1));\r\n    quads.push(new Quad(600, 400, 64, 64, 1, 0, 1));\r\n\r\n    window['quads'] = quads;\r\n\r\n    const vertexBuffer = gl.createBuffer();\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n    \r\n    const indexBuffer = gl.createBuffer();\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);\r\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n\r\n    function getOrtho (left: number, right: number, bottom: number, top: number, near: number, far: number): Float32Array\r\n    {\r\n        const leftRight: number = 1 / (left - right);\r\n        const bottomTop: number = 1 / (bottom - top);\r\n        const nearFar: number = 1 / (near - far);\r\n      \r\n        const m00: number = -2 * leftRight;\r\n        const m11: number = -2 * bottomTop;\r\n        const m22: number = 2 * nearFar;\r\n        const m30: number = (left + right) * leftRight;\r\n        const m31: number = (top + bottom) * bottomTop;\r\n        const m32: number = (far + near) * nearFar;\r\n    \r\n        return new Float32Array([ m00, 0, 0, 0, 0, m11, 0, 0, 0, 0, m22, 0, m30, m31, m32, 1 ]);\r\n    }\r\n\r\n    function Identity (src: Float32Array): Float32Array\r\n    {\r\n        src[0] = 1;\r\n        src[1] = 0;\r\n        src[2] = 0;\r\n        src[3] = 0;\r\n        src[4] = 0;\r\n        src[5] = 1;\r\n        src[6] = 0;\r\n        src[7] = 0;\r\n        src[8] = 0;\r\n        src[9] = 0;\r\n        src[10] = 1;\r\n        src[11] = 0;\r\n        src[12] = 0;\r\n        src[13] = 0;\r\n        src[14] = 0;\r\n        src[15] = 1;\r\n\r\n        return src;\r\n    }\r\n\r\n    function Translate (src: Float32Array, x: number = 0, y: number = 0, z: number = 0): Float32Array\r\n    {\r\n        const m00 = src[0];\r\n        const m01 = src[1];\r\n        const m02 = src[2];\r\n        const m03 = src[3];\r\n        const m10 = src[4];\r\n        const m11 = src[5];\r\n        const m12 = src[6];\r\n        const m13 = src[7];\r\n        const m20 = src[8];\r\n        const m21 = src[9];\r\n        const m22 = src[10];\r\n        const m23 = src[11];\r\n        const m30 = src[12];\r\n        const m31 = src[13];\r\n        const m32 = src[14];\r\n        const m33 = src[15];\r\n    \r\n        const a30 = m00 * x + m10 * y + m20 * z + m30;\r\n        const a31 = m01 * x + m11 * y + m21 * z + m31;\r\n        const a32 = m02 * x + m12 * y + m22 * z + m32;\r\n        const a33 = m03 * x + m13 * y + m23 * z + m33;\r\n    \r\n        src[12] = a30;\r\n        src[13] = a31;\r\n        src[14] = a32;\r\n        src[15] = a33;\r\n\r\n        return src;\r\n    }\r\n\r\n    function Scale (src: Float32Array, scaleX: number, scaleY: number, scaleZ: number): Float32Array\r\n    {\r\n        src[0] *= scaleX;\r\n        src[1] *= scaleX;\r\n        src[2] *= scaleX;\r\n        src[3] *= scaleX;\r\n        src[4] *= scaleY;\r\n        src[5] *= scaleY;\r\n        src[6] *= scaleY;\r\n        src[7] *= scaleY;\r\n        src[8] *= scaleZ;\r\n        src[9] *= scaleZ;\r\n        src[10] *= scaleZ;\r\n        src[11] *= scaleZ;\r\n\r\n        return src;\r\n    }\r\n\r\n    function RotateZ (src: Float32Array, angle: number): Float32Array\r\n    {\r\n        const s: number = Math.sin(angle);\r\n        const c: number = Math.cos(angle);\r\n    \r\n        const m00 = src[0];\r\n        const m01 = src[1];\r\n        const m02 = src[2];\r\n        const m03 = src[3];\r\n        const m10 = src[4];\r\n        const m11 = src[5];\r\n        const m12 = src[6];\r\n        const m13 = src[7];\r\n    \r\n        const a00: number = m00 * c + m10 * s;\r\n        const a01: number = m01 * c + m11 * s;\r\n        const a02: number = m02 * c + m12 * s;\r\n        const a03: number = m03 * c + m13 * s;\r\n        const a10: number = m10 * c - m00 * s;\r\n        const a11: number = m11 * c - m01 * s;\r\n        const a12: number = m12 * c - m02 * s;\r\n        const a13: number = m13 * c - m03 * s;\r\n        \r\n        src[0] = a00;\r\n        src[1] = a01;\r\n        src[2] = a02;\r\n        src[3] = a03;\r\n        src[4] = a10;\r\n        src[5] = a11;\r\n        src[6] = a12;\r\n        src[7] = a13;\r\n\r\n        return src;\r\n    }\r\n\r\n    //  This matrix will convert from pixels to clip space - it only needs to be set when the canvas is sized\r\n    const projectionMatrix = getOrtho(0, resolution.x, resolution.y, 0, -1000, 1000);\r\n\r\n    const stride = 24;\r\n\r\n    //  This approach only works for a single quad\r\n    function render ()\r\n    {\r\n        gl.clearColor(0, 0, 0, 1);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n\r\n        gl.enable(gl.BLEND);\r\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n        gl.viewport(0, 0, canvas.width, canvas.height);\r\n    \r\n        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);\r\n\r\n        gl.vertexAttribPointer(vertexPositionAttrib, 2, gl.FLOAT, false, stride, 0);\r\n        gl.vertexAttribPointer(vertexColorAttrib, 4, gl.FLOAT, false, stride, 8);\r\n\r\n        gl.uniformMatrix4fv(uProjectionMatrix, false, projectionMatrix);\r\n\r\n        for (let i = 0; i < quads.length; i++)\r\n        {\r\n            quads[i].update();\r\n\r\n            gl.uniformMatrix4fv(uModelTransform, false, quads[i].modelTransform);\r\n    \r\n            //  draw one quad at a time! Terrible for performance, but for our purposes here, it'll work.\r\n            //  the next stage will be to not use a uniform for the model transform, as we can't batch our quads\r\n\r\n            //  count = how many indicies are there per quad in the element array (6)\r\n            //  offset = byte offset in element array buffer, i.e. how many indicies are there per quad (6) * 2 (as they're floats) = 12 bytes\r\n            gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, i * 12);\r\n        }\r\n\r\n        requestAnimationFrame(render);\r\n    }\r\n    \r\n    requestAnimationFrame(render);\r\n}\r\n","import part01 from './part01';\r\nimport part02 from './part02';\r\nimport part03 from './part03';\r\nimport part04 from './part04';\r\nimport part05 from './part05';\r\nimport part06 from './part06';\r\nimport part07 from './part07';\r\nimport part08 from './part08';\r\nimport part09 from './part09';\r\n\r\npart09();\r\n"],"names":["fs","vs","canvas","document","getElementById","width","height","gl","getContext","fragmentShader","createShader","FRAGMENT_SHADER","shaderSource","compileShader","vertexShader","VERTEX_SHADER","program","createProgram","attachShader","linkProgram","useProgram","vertexPositionAttrib","getAttribLocation","vertexColorAttrib","uModelTransform","getUniformLocation","uProjectionMatrix","enableVertexAttribArray","vertices","indices","totalQuads","resolution","x","y","addQuad","r","g","b","a","x1","y1","x2","y2","push","offset","Quad","constructor","rotation","scaleX","scaleY","modelTransform","Float32Array","update","Identity","Translate","RotateZ","Scale","quads","window","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","indexBuffer","ELEMENT_ARRAY_BUFFER","Uint16Array","getOrtho","left","right","bottom","top","near","far","leftRight","bottomTop","nearFar","m00","m11","m22","m30","m31","m32","src","z","m01","m02","m03","m10","m12","m13","m20","m21","m23","m33","a30","a31","a32","a33","scaleZ","angle","s","Math","sin","c","cos","a00","a01","a02","a03","a10","a11","a12","a13","projectionMatrix","stride","render","clearColor","clear","COLOR_BUFFER_BIT","enable","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","viewport","vertexAttribPointer","FLOAT","uniformMatrix4fv","i","length","drawElements","TRIANGLES","UNSIGNED_SHORT","requestAnimationFrame","part09"],"mappings":"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"}