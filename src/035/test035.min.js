!function(){"use strict";class t{constructor(t=0,e=0){this.set(t,e)}set(t=0,e=0){return this.x=t,this.y=e,this}zero(){return this.set()}getArray(){return[this.x,this.y]}fromArray(t){return this.set(t[0],t[1])}[Symbol.iterator](){return this.getArray()[Symbol.iterator]()}}class e{constructor(e,i,o){this.rgba={r:1,g:1,b:1,a:1},this.visible=!0,this.texture=null,this.uv={topLeft:{x:0,y:0},topRight:{x:1,y:0},bottomLeft:{x:0,y:1},bottomRight:{x:1,y:1}},this.bounds=null,this._a=1,this._b=0,this._c=0,this._d=1,this._tx=0,this._ty=0,this.gravity=.75,this.speedX=10*Math.random(),this.speedY=10*Math.random()-5,this.texture=o,this._size=new t(o.width,o.height),this.topLeft=new t,this.topRight=new t,this.bottomLeft=new t,this.bottomRight=new t,this._position=new t(e,i),this._scale=new t(1,1),this._skew=new t(0,0),this._origin=new t(0,0),this._rotation=0,this.setOrigin(.5,1)}setOrigin(t,e=t){return this._origin.set(t,e),this}setTexture(t){return this.texture=t,this._size.set(t.width,t.height),this}stepNoTexture(t,e,i){this.x+=this.speedX,this.y+=this.speedY,this.speedY+=this.gravity,this.x>this.bounds.right?(this.speedX*=-1,this.x=this.bounds.right):this.x<this.bounds.left&&(this.speedX*=-1,this.x=this.bounds.left),this.y>this.bounds.bottom?(this.speedY*=-.85,this.y=this.bounds.bottom,Math.random()>.5&&(this.speedY-=6*Math.random())):this.y<this.bounds.top&&(this.speedY=0,this.y=this.bounds.top),this._tx=this.x,this._ty=this.y;const o=this._size.x,n=this._size.y,s=-this._origin.x*o,r=s+o,h=-this._origin.y*n,a=h+n,{_a:d,_b:u,_c:l,_d:m,_tx:c,_ty:g}=this,E=s*d,_=s*u,R=h*l,x=h*m,T=r*d,b=r*u,f=a*l,A=a*m;this.topLeft.set(E+R+c,_+x+g),this.topRight.set(T+R+c,b+x+g),this.bottomLeft.set(E+f+c,_+A+g),this.bottomRight.set(T+f+c,b+A+g),t[e+0]=this.topLeft.x,t[e+1]=this.topLeft.y,t[e+2]=i,t[e+3]=this.uv.topLeft.x,t[e+4]=this.uv.topLeft.y,t[e+5]=this.bottomLeft.x,t[e+6]=this.bottomLeft.y,t[e+7]=i,t[e+8]=this.uv.bottomLeft.x,t[e+9]=this.uv.bottomLeft.y,t[e+10]=this.bottomRight.x,t[e+11]=this.bottomRight.y,t[e+12]=i,t[e+13]=this.uv.bottomRight.x,t[e+14]=this.uv.bottomRight.y,t[e+15]=this.topRight.x,t[e+16]=this.topRight.y,t[e+17]=i,t[e+18]=this.uv.topRight.x,t[e+19]=this.uv.topRight.y}set x(t){this._position.x=t}get x(){return this._position.x}set y(t){this._position.y=t}get y(){return this._position.y}}class i{constructor(t,e,i=0){this.glIndex=0,this.key=t,this.gl=e,this.glIndex=i}onLoad(){const t=this.gl;this.glTexture=this.gl.createTexture(),t.activeTexture(t.TEXTURE0+this.glIndex),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.image),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this.width=this.image.width,this.height=this.image.height,this.image.onload=null,this._onLoadCallback&&this._onLoadCallback(this)}load(t,e){this.image=new Image,this.image.onload=()=>this.onLoad(),this.image.src=t,e&&(this._onLoadCallback=e),this.image.complete&&this.image.width&&this.image.height&&this.onLoad()}}var o={fragmentShader:"\nprecision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uTexture;\n\nvoid main (void)\n{\n    gl_FragColor = texture2D(uTexture, vTextureCoord);\n}",vertexShader:"\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main (void)\n{\n    vTextureCoord = aTextureCoord;\n\n    gl_Position = uProjectionMatrix * vec4(aVertexPosition, 1.0);\n}"};!function(t){if("complete"===document.readyState||"interactive"===document.readyState)return void t();const e=()=>{document.removeEventListener("deviceready",e,!0),document.removeEventListener("DOMContentLoaded",e,!0),window.removeEventListener("load",e,!0),t()};document.body?window.hasOwnProperty("cordova")?document.addEventListener("deviceready",e,!0):(document.addEventListener("DOMContentLoaded",e,!0),window.addEventListener("load",e,!0)):window.setTimeout(e,20)}((function(){const t=800,n=600,s={left:0,top:0,right:t,bottom:n},r=document.getElementById("game");r.width=t,r.height=n;const h=r.getContext("webgl",{alpha:!1,antialias:!1,premultipliedAlpha:!1,stencil:!1,preserveDrawingBuffer:!1}),a=h.createShader(h.FRAGMENT_SHADER);h.shaderSource(a,o.fragmentShader),h.compileShader(a);const d=h.createShader(h.VERTEX_SHADER);h.shaderSource(d,o.vertexShader),h.compileShader(d);const u=h.createProgram();h.attachShader(u,d),h.attachShader(u,a),h.linkProgram(u),h.useProgram(u);const l=h.getAttribLocation(u,"aVertexPosition"),m=h.getAttribLocation(u,"aTextureCoord"),c=h.getUniformLocation(u,"uProjectionMatrix"),g=h.getUniformLocation(u,"uTexture");h.enableVertexAttribArray(l),h.enableVertexAttribArray(m);let E=0,_=!1;const R=new Float32Array(327680);let x=[];for(let t=0;t<16384;t+=4)x.push(t+0,t+1,t+2,t+2,t+3,t+0);const T=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,T),h.bufferData(h.ARRAY_BUFFER,R,h.DYNAMIC_DRAW),h.bindBuffer(h.ARRAY_BUFFER,null);const b=h.createBuffer();h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,b),h.bufferData(h.ELEMENT_ARRAY_BUFFER,new Uint16Array(x),h.STATIC_DRAW),h.bindBuffer(h.ARRAY_BUFFER,null);const f=new Float32Array([1/-t*-2,0,0,0,0,1/n*-2,0,0,0,0,1/(-1e4-1e4)*2,0,-1,1,0,1]),A=[];!function(t){let e=t.length;const o=()=>{e--,0===e&&function(){v(1e3);let t=document.getElementById("gameParent");y=new window.Stats,y.domElement.id="stats",document.body.append(y.domElement),L=document.createElement("div"),L.innerText=E.toString(),t.append(L),document.getElementById("toggle").addEventListener("click",()=>{w=!w});let e=document.getElementById("game");e.addEventListener("mousedown",()=>{_=!0}),e.addEventListener("mouseup",()=>{_=!1});for(let t=0;t<A.length;t++)h.activeTexture(h.TEXTURE0+t),h.bindTexture(h.TEXTURE_2D,A[t].glTexture);h.enable(h.BLEND),h.blendFunc(h.ONE,h.ONE_MINUS_SRC_ALPHA),h.enable(h.DEPTH_TEST),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,b),h.bindBuffer(h.ARRAY_BUFFER,T),S()}()};t.forEach(t=>{let e=new i(t,h,A.length);e.load("../assets/bunnies/"+t,o),A.push(e)})}(["rabbitv3.png"]);const p=[];function v(t){for(let i=0;i<t;i++){let t=new e(E%2*800,0,A[0]);t.bounds=s,p.push(t),E++}}let y,L,w=!1;function F(t){const e=80*t;if(327680===e)h.bufferData(h.ARRAY_BUFFER,R,h.DYNAMIC_DRAW);else{let t=R.subarray(0,e);h.bufferSubData(h.ARRAY_BUFFER,0,t)}h.drawElements(h.TRIANGLES,6*t,h.UNSIGNED_SHORT,0)}function S(){if(w)return void requestAnimationFrame(S);y.begin(),_&&E<5e5&&(v(200),L.innerText=E.toString()),h.clearColor(0,0,0,1),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),h.enable(h.BLEND),h.blendFunc(h.ONE,h.ONE_MINUS_SRC_ALPHA),h.viewport(0,0,r.width,r.height),h.uniformMatrix4fv(c,!1,f),h.uniform1i(g,0),h.vertexAttribPointer(l,3,h.FLOAT,!1,20,0),h.vertexAttribPointer(m,2,h.FLOAT,!1,20,12);let t=0;for(let e=p.length-1;e>=0;e--){p[e].stepNoTexture(R,20*t,e/1e4),4096===t?(F(t),t=0):t++}t>0&&F(t),requestAnimationFrame(S),y.end()}}))}();
